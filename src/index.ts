import { Telegraf, Markup, Context } from 'telegraf';
import dotenv from 'dotenv';

dotenv.config();

const token = process.env.BOT_TOKEN;

if (!token) {
  console.error('‚ùå BOT_TOKEN not found in .env');
  process.exit(1);
}

const bot = new Telegraf<Context>(token);

// --- –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ ---
const mainKeyboard = Markup.keyboard([
  ['üîé –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞', '‚ö†Ô∏è –§–∞–∫—Ç–æ—Ä—ã —Ä–∏—Å–∫–∞'],
  ['ü©∫ –ê–ª–≥–æ—Ä–∏—Ç–º –¥–µ–π—Å—Ç–≤–∏–π', 'üìä –≠–ö–ì-–ø—Ä–∏–∑–Ω–∞–∫–∏'],
  ['üîÅ –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è', '‚ÑπÔ∏è –û –±–æ—Ç–µ']
])
  .resize()
  .oneTime(false);

// --- –ö–æ–º–∞–Ω–¥–∞ /start ---
bot.start((ctx) => {
  const text = `–ü—Ä–∏–≤–µ—Ç! –Ø @telahelp_bot ‚Äî –∫—Ä–∞—Ç–∫–∏–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ —Ç—Ä–æ–º–±–æ—ç–º–±–æ–ª–∏–∏ –ª–µ–≥–æ—á–Ω–æ–π –∞—Ä—Ç–µ—Ä–∏–∏ (–¢–≠–õ–ê).\n\n–í—ã–±–µ—Ä–∏ —Ä–∞–∑–¥–µ–ª –Ω–∏–∂–µ:`;
  ctx.reply(text, mainKeyboard);
});

// --- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ ---
bot.hears('üîé –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞', (ctx) => {
  const text = `*–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¢–≠–õ–ê:*\n\n` +
    `‚Ä¢ –ú–∞—Å—Å–∏–≤–Ω–∞—è –¢–≠–õ–ê ‚Äî –≤–Ω–µ–∑–∞–ø–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫—Ä–æ–≤–æ–æ–±—Ä–∞—â–µ–Ω–∏—è –∏–ª–∏ —à–æ–∫, –≤—ã—Ä–∞–∂–µ–Ω–Ω–∞—è –æ–¥—ã—à–∫–∞, —Ç–∞—Ö–∏–∫–∞—Ä–¥–∏—è, —Ü–∏–∞–Ω–æ–∑ –≤–µ—Ä—Ö–Ω–µ–π –ø–æ–ª–æ–≤–∏–Ω—ã —Ç–µ–ª–∞, –Ω–∞–±—É—Ö–∞–Ω–∏–µ —à–µ–π–Ω—ã—Ö –≤–µ–Ω, –∞–Ω–≥–∏–Ω–æ–∑–Ω–æ-–ø–æ–¥–æ–±–Ω–∞—è –±–æ–ª—å.\n\n` +
    `‚Ä¢ –¢–≠–õ–ê –º–µ–ª–∫–∏—Ö –≤–µ—Ç–≤–µ–π ‚Äî –æ–¥—ã—à–∫–∞, —Ç–∞—Ö–∏–∫–∞—Ä–¥–∏—è, –≥–∏–ø–æ—Ç–µ–Ω–∑–∏—è, –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–Ω—Ñ–∞—Ä–∫—Ç–∞ –ª—ë–≥–∫–æ–≥–æ (–ª–∏—Ö–æ—Ä–∞–¥–∫–∞, –±–æ–ª—å, –∫–∞—à–µ–ª—å, —Ö—Ä–∏–ø—ã, –∫—Ä–æ–≤—è–Ω–∏—Å—Ç–∞—è –º–æ–∫—Ä–æ—Ç–∞).`;
  ctx.replyWithMarkdown(text);
});

// --- –§–∞–∫—Ç–æ—Ä—ã —Ä–∏—Å–∫–∞ ---
bot.hears('‚ö†Ô∏è –§–∞–∫—Ç–æ—Ä—ã —Ä–∏—Å–∫–∞', (ctx) => {
  const text = `*–§–∞–∫—Ç–æ—Ä—ã —Ä–∏—Å–∫–∞ –¢–≠–õ–ê:*\n\n` +
    `‚Ä¢ –¢—Ä–æ–º–±–æ—ç–º–±–æ–ª–∏—á–µ—Å–∫–∏–µ –æ—Å–ª–æ–∂–Ω–µ–Ω–∏—è –≤ –∞–Ω–∞–º–Ω–µ–∑–µ\n` +
    `‚Ä¢ –ü–æ–∂–∏–ª–æ–π –≤–æ–∑—Ä–∞—Å—Ç\n` +
    `‚Ä¢ –ò–º–º–æ–±–∏–ª–∏–∑–∞—Ü–∏—è\n` +
    `‚Ä¢ –ù–µ–¥–∞–≤–Ω—è—è –æ–ø–µ—Ä–∞—Ü–∏—è\n` +
    `‚Ä¢ –ü–µ—Ä–µ–ª–æ–º—ã –¥–ª–∏–Ω–Ω—ã—Ö –∫–æ—Å—Ç–µ–π\n` +
    `‚Ä¢ –¢—Ä–æ–º–±–æ–∑ –≥–ª—É–±–æ–∫–∏—Ö –≤–µ–Ω\n` +
    `‚Ä¢ –°–µ—Ä–¥–µ—á–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å, –º–µ—Ä—Ü–∞—Ç–µ–ª—å–Ω–∞—è –∞—Ä–∏—Ç–º–∏—è\n` +
    `‚Ä¢ –û–Ω–∫–æ–ª–æ–≥–∏—è\n` +
    `‚Ä¢ –ë–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å, –ø–æ—Å–ª–µ—Ä–æ–¥–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥\n` +
    `‚Ä¢ –ü—Ä–∏—ë–º –û–ö, –¥–∏—É—Ä–µ—Ç–∏–∫–æ–≤, –≥–æ—Ä–º–æ–Ω–∞–ª—å–Ω–∞—è —Ç–µ—Ä–∞–ø–∏—è`;
  ctx.replyWithMarkdown(text);
});

// --- –ê–ª–≥–æ—Ä–∏—Ç–º –¥–µ–π—Å—Ç–≤–∏–π ---
bot.hears('ü©∫ –ê–ª–≥–æ—Ä–∏—Ç–º –¥–µ–π—Å—Ç–≤–∏–π', (ctx) => {
  const text = `*–ê–ª–≥–æ—Ä–∏—Ç–º –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä–∏ –¢–≠–õ–ê:*\n\n` +
    `1Ô∏è‚É£ –ü—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –∫—Ä–æ–≤–æ–æ–±—Ä–∞—â–µ–Ω–∏—è ‚Äî –ø—Ä–æ—Ç–æ–∫–æ–ª ¬´–í–Ω–µ–∑–∞–ø–Ω–∞—è —Å–µ—Ä–¥–µ—á–Ω–∞—è —Å–º–µ—Ä—Ç—å¬ª.\n\n` +
    `2Ô∏è‚É£ –ü—Ä–∏ –º–∞—Å—Å–∏–≤–Ω–æ–π –¢–≠–õ–ê —Å –≥–∏–ø–æ—Ç–µ–Ω–∑–∏–µ–π:\n` +
    `‚Ä¢ –û–∫—Å–∏–≥–µ–Ω–æ—Ç–µ—Ä–∞–ø–∏—è\n` +
    `‚Ä¢ –ö–∞—Ç–µ—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ø–µ—Ä–∏—Ñ–µ—Ä–∏—á–µ—Å–∫–æ–π –≤–µ–Ω—ã\n` +
    `‚Ä¢ –ì–µ–ø–∞—Ä–∏–Ω 10 000 –ï–î –≤/–≤ —Å—Ç—Ä—É–π–Ω–æ, –∑–∞—Ç–µ–º –∫–∞–ø–µ–ª—å–Ω–æ 18 –ï–î/–∫–≥/–º–∏–Ω\n` +
    `‚Ä¢ –ò–Ω—Ñ—É–∑–∏–æ–Ω–Ω–∞—è —Ç–µ—Ä–∞–ø–∏—è (5% –≥–ª—é–∫–æ–∑–∞ –∏ –¥—Ä.)\n` +
    `‚Ä¢ –ü—Ä–∏ –≥–∏–ø–æ—Ç–µ–Ω–∑–∏–∏ ‚Äî –¥–æ–ø–∞–º–∏–Ω 2.5 –º–∫–≥/–∫–≥/–º–∏–Ω –∏–ª–∏ –Ω–æ—Ä—ç–ø–∏–Ω–µ—Ñ—Ä–∏–Ω 0.5‚Äì1 –º–∫–≥/–º–∏–Ω\n` +
    `‚Ä¢ –û–±–µ–∑–±–æ–ª–∏–≤–∞–Ω–∏–µ: –º–æ—Ä—Ñ–∏–Ω 10 –º–≥ –∏–ª–∏ —Ñ–µ–Ω—Ç–∞–Ω–∏–ª 0.01 –º–≥ + –¥—Ä–æ–ø–µ—Ä–∏–¥–æ–ª 2.5‚Äì5 –º–≥\n` +
    `‚Ä¢ –ü—Ä–∏ –±—Ä–æ–Ω—Ö–æ—Å–ø–∞–∑–º–µ ‚Äî –∞–º–∏–Ω–æ—Ñ–∏–ª–ª–∏–Ω 2.4% 5‚Äì10 –º–ª –≤/–≤ –º–µ–¥–ª–µ–Ω–Ω–æ\n` +
    `‚Ä¢ –ü—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–∏ –≤–∏—Ç–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π ‚Äî –∏–Ω—Ç—É–±–∞—Ü–∏—è, –ò–í–õ\n` +
    `‚Ä¢ –ü—Ä–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ‚Äî —Ç—Ä–æ–º–±–æ–ª–∏—Ç–∏—á–µ—Å–∫–∞—è —Ç–µ—Ä–∞–ø–∏—è\n\n` +
    `3Ô∏è‚É£ –ü—Ä–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ–º –ê–î:\n` +
    `‚Ä¢ –û–∫—Å–∏–≥–µ–Ω–æ—Ç–µ—Ä–∞–ø–∏—è, –∫–∞—Ç–µ—Ç–µ—Ä–∏–∑–∞—Ü–∏—è\n` +
    `‚Ä¢ –ì–µ–ø–∞—Ä–∏–Ω 10 000 –ï–î –≤/–≤, –∑–∞—Ç–µ–º 1000 –ï–î/—á –∏–ª–∏ 5000 –ï–î –ø/–∫ –∫–∞–∂–¥—ã–µ 8 —á\n` +
    `‚Ä¢ –ê–º–∏–Ω–æ—Ñ–∏–ª–ª–∏–Ω 240 –º–≥ –≤/–≤`;
  ctx.replyWithMarkdown(text);
});

// --- –≠–ö–ì ---
bot.hears('üìä –≠–ö–ì-–ø—Ä–∏–∑–Ω–∞–∫–∏', (ctx) => {
  const text = `*–≠–ö–ì-–ø—Ä–∏–∑–Ω–∞–∫–∏ –¢–≠–õ–ê:*\n\n` +
    `‚Ä¢ –ì–ª—É–±–æ–∫–∏–π S –≤ I\n` +
    `‚Ä¢ –ì–ª—É–±–æ–∫–∏–π Q –≤ III\n` +
    `‚Ä¢ –°–º–µ—â–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–Ω–æ–π –∑–æ–Ω—ã –≤–ª–µ–≤–æ\n` +
    `‚Ä¢ –ë–ª–æ–∫–∞–¥–∞ –ø—Ä–∞–≤–æ–π –Ω–æ–∂–∫–∏ –ø—É—á–∫–∞ –ì–∏—Å–∞\n\n` +
    `–í 20% —Å–ª—É—á–∞–µ–≤ –≠–ö–ì –º–æ–∂–µ—Ç –±—ã—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.`;
  ctx.replyWithMarkdown(text);
});

// --- –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è ---
bot.hears('üîÅ –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è', (ctx) => {
  const text = `*–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:*\n\n` +
    `‚Ä¢ –ò–Ω—Ñ–∞—Ä–∫—Ç –º–∏–æ–∫–∞—Ä–¥–∞\n` +
    `‚Ä¢ –û—Å—Ç—Ä–∞—è —Å–µ—Ä–¥–µ—á–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å (–∞—Å—Ç–º–∞, –æ—Ç—ë–∫ –ª—ë–≥–∫–∏—Ö, —à–æ–∫)\n` +
    `‚Ä¢ –†–µ–∂–µ: –±—Ä–æ–Ω—Ö–∏–∞–ª—å–Ω–∞—è –∞—Å—Ç–º–∞, –ø–Ω–µ–≤–º–æ–Ω–∏—è, —Å–ø–æ–Ω—Ç–∞–Ω–Ω—ã–π –ø–Ω–µ–≤–º–æ—Ç–æ—Ä–∞–∫—Å`;
  ctx.replyWithMarkdown(text);
});

// --- –û –±–æ—Ç–µ ---
bot.hears('‚ÑπÔ∏è –û –±–æ—Ç–µ', (ctx) => {
  const text = `@telahelp_bot ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ –¢–≠–õ–ê.\n\n–ù–µ –∑–∞–º–µ–Ω—è–µ—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –≤—Ä–∞—á–∞. –ü—Ä–∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ ‚Äî –≤—ã–∑—ã–≤–∞–π —Å–∫–æ—Ä—É—é –ø–æ–º–æ—â—å.`;
  ctx.reply(text);
});

// --- fallback ---
bot.on('text', (ctx) => {
  ctx.reply('–ù–µ –ø–æ–Ω—è–ª –∫–æ–º–∞–Ω–¥—É. –í—ã–±–µ—Ä–∏ —Ä–∞–∑–¥–µ–ª –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ.', mainKeyboard);
});

// --- –ó–∞–ø—É—Å–∫ ---
bot.launch().then(() => console.log('‚úÖ Bot started successfully'));

process.once('SIGINT', () => bot.stop('SIGINT'));
process.once('SIGTERM', () => bot.stop('SIGTERM'));
